---
import { parseHref } from "@lib/helpers";

interface Props {
  size?: "sm" | "md" | "lg";
  icon?: "phone" | "info" | "email" | "none";
  style?: "primary" | "secondary" | "tertiary";
  color?: "light" | "dark";
  class?: string;
  link?: string;
  iconOnly?: boolean;
  longText?: boolean;
  decorative?: boolean;
  [x: string]: any;
}

const {
  size = "md",
  style = "primary",
  color = "dark",
  icon = "none",
  iconOnly = false,
  longText = false,
  decorative = false,
  class: className,
  link,
  ...rest
} = Astro.props;

const sizes = {
  sm: "px-4 py-2 text-[1rem]",
  md: "px-4 py-4 text-[1rem]",
  lg: "px-4 py-5 text-[1rem] md:p-6 md:text-[1.375rem]",
};

const styles = {
  primary_dark:
    "gap-2 bg-tertiary text-black hover:bg-orange-300 border border-transparent focus-visible:outline-tertiary",
  primary_light:
    "gap-2 bg-blue-500 text-white hover:bg-blue-700 border border-transparent focus-visible:outline-orange",
  secondary_dark:
    "gap-2 bg-transparant text-tertiary border-2 border-white hover:bg-blue-200 hover:border-tertiary box-border focus-visible:outline-tertiary",
  secondary_light:
    "gap-2 bg-transparant text-black border-2 border-blue-900 hover:bg-primary/10 hover:border-blue-500 box-border focus-visible:outline-orange",
  tertiary_light:
    "rounded-none text-white text-[1rem] font-light mt-3 hover:text-blue-100 focus-visible:outline-orange-500",
  tertiary_dark:
    "rounded-none text-black text-[1rem] font-light mt-3 hover:text-blue-600 focus-visible:outline-orange-500",
};

const iconFill = {
  primary_dark: "fill-black",
  primary_light: "fill-white",
  secondary_light: "fill-black",
  secondary_dark: "fill-tertiary",
};

const TagName = decorative ? "span" : "a";
---

<TagName
  {...rest}
  class:list={[
    "group/icon inline-flex flex-row items-center rounded-full text-center outline-offset-2 transition focus-visible:outline focus-visible:outline-2",
    style === "tertiary" || iconOnly || longText ? "" : sizes[size],
    iconOnly && size == "md" && "p-4",
    iconOnly && size == "lg" && "p-8",
    longText && size == "sm" && "px-4 py-1 text-[0.875rem] md:text-[1rem]",
    longText && size == "md" && "px-4 py-4 sm:px-4 sm:py-3.5",
    longText && size == "lg" && "px-4 py-2 md:p-6",
    styles[style + "_" + color],
    className,
  ]}
  href={parseHref(link)}
>
  {
    icon !== "none" && (
      <svg
        class:list={[
          iconFill[style + "_" + color],
          "h-6 w-6 shrink-0 will-change-transform animate-once animate-ease-out group-hover/icon:animate-jump motion-reduce:group-hover/icon:animate-none",
          size == "lg" && "mr-2 h-8 w-8",
          longText && "hidden sm:inline",
        ]}
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <use xlink:href={parseHref(`/icons/icon-sprite.svg#icon-${icon}`)} />
      </svg>
    )
  }
  {!iconOnly && <slot />}
  {
    style == "tertiary" && (
      <svg
        class="fill-current h-6 w-6 will-change-transform animate-ease-out group-hover/icon:animate-jump motion-reduce:group-hover/icon:animate-none"
        aria-hidden="true"
        focusable="false"
      >
        <use
          xlink:href={parseHref("/icons/icon-sprite.svg#icon-chevron-right")}
        />
      </svg>
    )
  }
</TagName>
